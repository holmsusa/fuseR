% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fuse-segment.R, R/methods-bioconductor.R
\name{fuse.segment}
\alias{fuse.segment}
\alias{fuse.segment.default}
\alias{fuse.segment.BSseq}
\alias{fuse.segment.methrix}
\title{Full FUSE segmentation pipeline}
\usage{
fuse.segment(x, ...)

\method{fuse.segment}{default}(x, K1, chr, pos, method = c("BIC", "AIC"), ...)

\method{fuse.segment}{BSseq}(x, method = c("BIC", "AIC"), ...)

\method{fuse.segment}{methrix}(x, method = c("BIC", "AIC"), ...)
}
\arguments{
\item{x}{Input object. One of:
\describe{
\item{matrix}{Unmethylated count matrix (K0).}
\item{BSseq}{A \code{BSseq} object.}
\item{methrix}{A \code{methrix} object.}
}}

\item{...}{Additional arguments depending on input type:
\describe{
\item{K1}{Methylated count matrix (required if \code{x} is a matrix).}
\item{chr}{Chromosome labels, one per CpG (matrix input only).}
\item{pos}{Genomic positions, one per CpG (matrix input only).}
\item{method}{Information criterion for model selection:
\code{"BIC"} (default) or \code{"AIC"}.}
}

For internal use, \code{x} corresponds to the unmethylated count matrix (\code{K0}).}

\item{K1}{Methylated count matrix (required if \code{x} is a matrix)}

\item{chr}{Chromosome labels, one per CpG (matrix input only)}

\item{pos}{Genomic positions, one per CpG (matrix input only)}

\item{method}{Information criterion for model selection: "BIC" (default) or "AIC"}
}
\value{
An object of class \code{fuse_summary}, containing:
\describe{
\item{summary}{Data frame with one row per genomic segment.}
\item{betas_per_segment}{Matrix of per-sample methylation estimates.}
\item{raw_beta}{Per-CpG methylation estimates.}
\item{raw_pos}{Genomic positions of CpGs.}
}
}
\description{
Performs the full FUSE segmentation workflow:
hierarchical clustering, model selection, tree cutting,
and genomic segment summarization.
}
\details{
\code{fuse.segment()} is an S3 generic with methods for:
\describe{
\item{\code{matrix}}{Raw count matrices (K0, K1) with genomic annotation.}
\item{\code{BSseq}}{Bioconductor \code{BSseq} objects.}
\item{\code{methrix}}{Bioconductor \code{methrix} objects (supports DelayedMatrix).}
}
}
\section{Automatic data extraction}{

For \code{BSseq} objects:
\itemize{
\item Methylated counts are obtained via \code{getCoverage(x, "M")}
\item Unmethylated counts via \code{getCoverage(x, "Cov") - M}
\item Chromosome and position from \code{rowRanges(x)}
}

For \code{methrix} objects:
\itemize{
\item Methylated counts via \code{get_matrix(x, "M")}
\item Total coverage via \code{get_matrix(x, "C")}
\item Unmethylated counts computed as \code{C - M}
\item Genomic coordinates extracted from locus metadata
}
}

