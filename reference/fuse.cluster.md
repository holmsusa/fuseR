# Perform Hierarchical Clustering on Methylation Data

Produces a hierarchical clustering tree based on the input matrices of
counts.

## Usage

``` r
fuse.cluster(K0, K1, chr = NULL, pos = NULL)
```

## Arguments

- K0:

  Integer or numeric matrix with unmethylated counts

- K1:

  Integer or numeric matrix with methylated counts

- chr:

  (Optional) Integer vector with chromosome info

- pos:

  (Optional) Integer vector with genomic coordinate positions

## Value

Clustering tree as a matrix, with the same structure as hclust,
including the columns

- m1:

  ID of first data point. \<0 is original point, \>0 is row of previous
  merge.

- m2:

  ID of second data point. \<0 is original point, \>0 is row of previous
  merge.

- logl_tot:

  Change in total log-likelihood of merge.

- logl_merge:

  Total cost of points in this merge.

- genomic_dist:

  Penalty for genomic distance between points.

## Examples

``` r
# Example: Clustering generated data
set.seed(1234)
K0 <- matrix(
  rep(c(sample(0:20, 200, replace = TRUE), sample(20:40, 200, replace = TRUE)), 2),
  nrow = 100, byrow = TRUE
)
K1 <- matrix(
  rep(c(sample(20:40, 200, replace = TRUE), sample(0:20, 200, replace = TRUE)), 2),
  nrow = 100, byrow = TRUE
)
tree <- fuse.cluster(K0, K1)
tree
#>         m1   m2    logl_tot  logl_merge genomic_dist
#>   [1,] -40  -41    4.745890    4.745890      1.14483
#>   [2,] -90  -91    4.745890    4.745890      1.14483
#>   [3,]  -6   -7    7.394532    7.394532      1.14483
#>   [4,] -56  -57    7.394532    7.394532      1.14483
#>   [5,] -13  -14    8.257038    8.257038      1.14483
#>   [6,] -63  -64    8.257038    8.257038      1.14483
#>   [7,] -44  -45    8.531066    8.531066      1.14483
#>   [8,] -94  -95    8.531066    8.531066      1.14483
#>   [9,] -42  -43   10.069508   10.069508      1.14483
#>  [10,] -92  -93   10.069508   10.069508      1.14483
#>  [11,]  -3   -4   10.074838   10.074838      1.14483
#>  [12,] -53  -54   10.074838   10.074838      1.14483
#>  [13,] -48  -49   10.287519   10.287519      1.14483
#>  [14,] -98  -99   10.287519   10.287519      1.14483
#>  [15,] -19  -20   10.810084   10.810084      1.14483
#>  [16,] -69  -70   10.810084   10.810084      1.14483
#>  [17,] -31  -32   11.111468   11.111468      1.14483
#>  [18,] -81  -82   11.111468   11.111468      1.14483
#>  [19,] -16  -17   11.374850   11.374850      1.14483
#>  [20,] -66  -67   11.374850   11.374850      1.14483
#>  [21,] -38  -39   11.488309   11.488309      1.14483
#>  [22,] -88  -89   11.488309   11.488309      1.14483
#>  [23,] -28  -29   14.688620   14.688620      1.14483
#>  [24,] -78  -79   14.688620   14.688620      1.14483
#>  [25,] -26  -27   15.170902   15.170902      1.14483
#>  [26,] -76  -77   15.170902   15.170902      1.14483
#>  [27,] -35  -36   17.209725   17.209725      1.14483
#>  [28,] -85  -86   17.209725   17.209725      1.14483
#>  [29,]  -9  -10   18.407134   18.407134      1.14483
#>  [30,] -59  -60   18.407134   18.407134      1.14483
#>  [31,] -21  -22   19.464621   19.464621      1.14483
#>  [32,] -71  -72   19.464621   19.464621      1.14483
#>  [33,]  -1   -2   19.722421   19.722421      1.14483
#>  [34,] -51  -52   19.722421   19.722421      1.14483
#>  [35,] -30   17    9.753578   20.865046      1.14483
#>  [36,] -80   18    9.753578   20.865046      1.14483
#>  [37,] -11  -12   22.482809   22.482809      1.14483
#>  [38,] -61  -62   22.482809   22.482809      1.14483
#>  [39,]  -5    3   15.312638   22.707169      1.14483
#>  [40,] -55    4   15.312638   22.707169      1.14483
#>  [41,]   7  -46   15.542385   24.073451      1.14483
#>  [42,]   8  -96   15.542385   24.073451      1.14483
#>  [43,]  21    1    9.375008   25.609206      1.14483
#>  [44,]  22    2    9.375008   25.609206      1.14483
#>  [45,]  13  -50   18.975164   29.262683      1.14483
#>  [46,]  14 -100   18.975164   29.262683      1.14483
#>  [47,] -23  -24   31.299302   31.299302      1.14483
#>  [48,] -73  -74   31.299302   31.299302      1.14483
#>  [49,] -34   27   15.656186   32.865910      1.14483
#>  [50,] -84   28   15.656186   32.865910      1.14483
#>  [51,]  -8   29   15.405146   33.812280      1.14483
#>  [52,] -58   30   15.405146   33.812280      1.14483
#>  [53,]   5  -15   25.819240   34.076278      1.14483
#>  [54,]   6  -65   25.819240   34.076278      1.14483
#>  [55,]  19  -18   23.494407   34.869257      1.14483
#>  [56,]  20  -68   23.494407   34.869257      1.14483
#>  [57,]  35  -33   26.309405   47.174451      1.14483
#>  [58,]  36  -83   26.309405   47.174451      1.14483
#>  [59,]  33   11   18.344049   48.141308      1.14483
#>  [60,]  34   12   18.344049   48.141308      1.14483
#>  [61,]  15   31   18.497838   48.772544      1.14483
#>  [62,]  16   32   18.497838   48.772544      1.14483
#>  [63,]  25   23   20.925483   50.785005      1.14483
#>  [64,]  26   24   20.925483   50.785005      1.14483
#>  [65,] -37   43   26.874343   52.483549      1.14483
#>  [66,] -87   44   26.874343   52.483549      1.14483
#>  [67,]  41  -47   29.145856   53.219307      1.14483
#>  [68,]  42  -97   29.145856   53.219307      1.14483
#>  [69,]  47  -25   27.985280   59.284581      1.14483
#>  [70,]  48  -75   27.985280   59.284581      1.14483
#>  [71,]  39   51   12.439239   68.958688      1.14483
#>  [72,]  40   52   12.439239   68.958688      1.14483
#>  [73,]  37   53   14.293104   70.852191      1.14483
#>  [74,]  38   54   14.293104   70.852191      1.14483
#>  [75,]  65    9   25.896198   88.449255      1.14483
#>  [76,]  66   10   25.896198   88.449255      1.14483
#>  [77,]  55   61    6.795741   90.437542      1.14483
#>  [78,]  56   62    6.795741   90.437542      1.14483
#>  [79,]  67   45   11.600742   94.082732      1.14483
#>  [80,]  68   46   11.600742   94.082732      1.14483
#>  [81,]  57   49   30.253565  110.293926      1.14483
#>  [82,]  58   50   30.253565  110.293926      1.14483
#>  [83,]  59   71    9.290299  126.390296      1.14483
#>  [84,]  60   72    9.290299  126.390296      1.14483
#>  [85,]  77   69    5.829966  155.552089      1.14483
#>  [86,]  78   70    5.829966  155.552089      1.14483
#>  [87,]  63   81   26.686063  187.764994      1.14483
#>  [88,]  64   82   26.686063  187.764994      1.14483
#>  [89,]  83   73    6.400751  203.643238      1.14483
#>  [90,]  84   74    6.400751  203.643238      1.14483
#>  [91,]  75   79   24.054433  206.586420      1.14483
#>  [92,]  76   80   24.054433  206.586420      1.14483
#>  [93,]  89   85   21.591884  380.787211      1.14483
#>  [94,]  90   86   21.591884  380.787211      1.14483
#>  [95,]  87   91   16.117039  410.468452      1.14483
#>  [96,]  88   92   16.117039  410.468452      1.14483
#>  [97,]  93   95 2255.945351 3047.201014      1.14483
#>  [98,]  94   96 2255.945351 3047.201014      1.14483
#>  [99,]  97   98    0.000000 6094.402028      1.14483
```
